.\" Automatically generated by Pandoc 2.17.1.1
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "scc-hypervisor-collector.service" "8" "June 2022" "" "scc-hypervisor-collector systemd integration"
.hy
.SH NAME
.PP
\f[B]scc-hypervisor-collector.service\f[R],
\f[B]scc-hypervisor-collector.timer\f[R] - \f[B]systemd(1)\f[R]
integration for \f[B]scc-hypervisor-collector(1)\f[R]
.SH SYNOPSIS
.PP
scc-hypervisor-collector.service
.PD 0
.P
.PD
scc-hypervisor-collector.timer
.SH DESCRIPTION
.PP
The \f[B]scc-hypervisor-collector.service\f[R] \f[B]systemd(1)\f[R] unit
will run the \f[B]scc-hypervisor-collector(1)\f[R] command as the
\f[B]scchvc\f[R] user (see below) when triggered, if a valid
configuration has been specified in the
\f[B]/var/lib/scchvc/.config/scc-hypervisor-collector\f[R].
.PP
The \f[B]scc-hypervisor-collector.timer\f[R] \f[B]systemd(1)\f[R] unit,
once enabled, will trigger the
\f[B]scc-hypervisor-collector.service\f[R] on a daily basis, randomly
skewed by up to 15 minutes.
.SH RESTRICTED SERVICE ACCOUNT
.PP
Installation of the \f[B]scc-hypervisor-collector\f[R] package
automatically creates the \f[B]scchvc\f[R] user as a restricted service
account, if it doesn\[aq]t already exist, with a home directory of
\f[B]/var/lib/scchvc\f[R].
.SH CONFIGURATION
.PP
To take advantage of the \f[B]scc-hypervisor-collector.service\f[R], a
valid set of configuration settings must be created under the
\f[B]/var/lib/scchvc/.config/scc-hypervisor-collector\f[R] directory, as
documented in \f[B]scc-hypervisor-collector(5)\f[R].
.PP
Run \f[B]scc-hypervisor-collector --check\f[R] as the \f[B]scchvc\f[R]
user to validate that the settings are correct.
.PP
Ensure that the \f[B]scc-hypervisor-collector.timer\f[R] is enabled.
.SS TLS/SSL CERTIFICATES
.PP
The \f[B]virtual-host-gatherer(1)\f[R] framework only supports certs
that are registered with the system certificate stores.
See \f[B]update-ca-certificates(8)\f[R] for details.
.SS SSH KEYS
.PP
For any \f[B]Libvirt\f[R] hypervisors that are specified with a
\f[B]qemu+ssh\f[R] type URI, appropriate SSH keys that support
passwordless SSH access to the target hypervisor node, must be available
in the \f[B]/var/lib/scchvc/.ssh/\f[R] directory.
.PP
See \f[B]ssh-keygen(1)\f[R] for more details on how to generate
appropriate SSH keys if needed, and \f[B]ssh(1)\f[R] for the appropriate
permissions for the \f[B]/var/lib/scchvc/.ssh/\f[R] directory and any
keys stored there.
.SH CUSTOMIZATION
.PP
The \f[B]systemctl edit\f[R] mechanism can be used to customize either
of the \f[B]scc-hypervisor-collector.service\f[R] and
\f[B]scc-hypervisor-collector.timer\f[R] units.
.SS CHANGING WHICH USER THE SERVICE RUNS AS
.PP
To change the user that the \f[B]scc-hypervisor-collector.service\f[R]
runs the \f[B]scc-hypervisor-collector(1)\f[R] command as from the
\f[B]scchvc\f[R] user to \f[B]someuser\f[R] (with group membership
\f[B]somegroup\f[R]), create a drop-in snippet with the following
content:
.IP
.nf
\f[C]
[Service]
User=someuser
Group=somegroup
\f[R]
.fi
.SS CHANGING WHEN THE TIMER TRIGGERS
.PP
To change the timer trigger from a daily cadence to a weekly cadence,
with a randomised skew of up to 6 hours rather than 15 minutes, create a
drop-in snippet with the following content:
.IP
.nf
\f[C]
[Timer]
OnCalendar=weekly
RandomizedDelaySec=6h
\f[R]
.fi
.SH FILES AND DIRECTORIES
.TP
\f[B]/var/lib/scchvc/.config/scc-hypervisor-collector/\f[R]
Configuration directory that the
\f[B]scc-hypervisor-collector.service(8)\f[R] checks for configuration
settings.
Directory and files must be owned by, and only accessible by, the
\f[B]scchvc\f[R] user.
.TP
\f[B]/var/lib/scchvc/scc-hypervisor-collector.log\f[R]
The log file used by the \f[B]scc-hypervisor-collector.service(8)\f[R].
Log files must be owned by, and only accessible by, the \f[B]scchvc\f[R]
user.
Will be created with appropriate permissions if no log file exists.
.TP
\f[B]/var/lib/scchvc/.ssh/\f[R] (optional)
Directory holding any SSH keys (\f[B]ssh-keygen\f[R]) needed to access
\f[B]Libvirt\f[R] with \f[B]qemu+ssh\f[R] URIs.
.SH AUTHORS
.PP
Originally developed by Fergal Mc Carthy (fmccarthy\[at]suse.com) and
Meera Belur (mbelur\[at]suse.com) for the SCC at SUSE LLC
(scc-feedback\[at]suse.de)
.SH LINKS
.PP
SUSE Customer Center: https://scc.suse.com
.PP
scc-hypervisor-collector on GitHub:
https://github.com/SUSE/scc-hypervisor-collector
.PP
virtual-host-gatherer on GitHub:
https://github.com/uyuni-project/virtual-host-gatherer
.SH SEE ALSO
.PP
\f[B]scc-hypervisor-collector(1)\f[R],
\f[B]scc-hypervisor-collector(5)\f[R], \f[B]systemd(1)\f[R],
\f[B]ssh(1)\f[R], \f[B]ssh-keygen(1)\f[R]
