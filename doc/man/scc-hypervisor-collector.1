.\" Automatically generated by Pandoc 2.9.2.1
.\"
.TH "SCC-HYPERVISOR-COLLECTOR" "1" "June 2022" "" "SCC Hypervisor Collector"
.hy
.SH NAME
.PP
\f[B]scc-hypervisor-collector\f[R] - Collect & Upload Hypervisor details
to SUSE Customer Center
.SH SYNOPSIS
.PP
\f[B]scc-hypervisor-collector [<optional>...]\f[R]
.SH DESCRIPTION
.PP
The \f[B]scc-hypervisor-collector\f[R] collects details that are
relevant to SUSE Customer Center (SCC) subscription compliance tracking,
from the specified hypervisors.
.PP
The collected details include the total system RAM, CPU architecture and
topology of the hypervisor nodes themselves, as well as the UUIDs and
state (running or shutoff) for the hosted VMs.
.SS HYPERVISOR DETAILS RETRIEVAL
.PP
The \f[B]gatherer\f[R] Python module provided by the
\f[B]virtual-host-gatherer(1)\f[R] command is used to retrieve the
details from the configured hypervisors.
.SH OPTIONS
.TP
\f[B]-c\f[R], \f[B]--config <CONFIG_FILE>\f[R]
Specifies a YAML file containing configuration settings.
.TP
\f[B]--config_dir\f[R], \f[B]--config-dir <CONFIG_DIR>\f[R]
Specifies a directory containing YAML configuration files that will be
merged together, in lexical sort order, to construct the configuration
settings.
Defaults to \f[B]\[ti]/.config/scc-hypervisor-collector\f[R].
.TP
\f[B]-C\f[R], \f[B]--check\f[R]
Checks the specified configuration settings for correctness, reporting
any issues found.
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Provides basic details about the available command line options.
.TP
\f[B]-q\f[R], \f[B]--quiet\f[R]
Runs in quiet mode, only reporting errors.
.TP
\f[B]-v\f[R], \f[B]--verbose\f[R]
Runs in verbose mode, reporting additional details.
.TP
\f[B]-V\f[R], \f[B]--version\f[R]
Reports the version of \f[B]scc-hypervisor-collector\f[R].
.TP
\f[B]-L\f[R], \f[B]--logfile <LOG_FILE>\f[R]
Specifies the path to the log file in which to write log messages.
Defaults to \f[B]\[ti]/scc-hypervisor-collector.log\f[R].
.SH SECURITY CONSIDERATIONS
.PP
The \f[B]scc-hypervisor-collector(1)\f[R] is intended to be run from a
restricted service account with no special privileges, and will exit
immediately if it detects that it is running with superuser privileges.
.SS CONFIGURATION SETTINGS PERMISSIONS
.PP
As the \f[B]scc-hypervisor-collector(5)\f[R] configuration settings will
contain sensitive information such as passwords, the command requires
that all specified configuration files and directories must be owned by
the non-root user that is running the command, with restrictive
permissions allowing only that user to access those files.
.SS TLS/SSL CERTIFICATES
.PP
The \f[B]virtual-host-gatherer(1)\f[R] framework doesn\[aq]t currently
permit the specification of certs that can be used to validate
connections to the specified hypervisors.
.PP
As such any certs that may be needed to securely connect to the
specified hypervisors will need to be registered with the system
certificate stores.
See \f[B]update-ca-certificates(8)\f[R] for details.
.SH SYSTEMD INTEGRATION
.PP
The \f[B]scc-hypervisor-collector\f[R] package, when installed,
automatically creates the \f[B]scchvc\f[R] restricted service account,
if it doesn\[aq]t already exist, with a home directory of
\f[B]/var/lib/scchvc\f[R].
.PP
Additionally two \f[B]systemd(1)\f[R] units are also installed:
.IP \[bu] 2
\f[B]scc-hypervisor-collector.service(8)\f[R] runs the
\f[B]scc-hypervisor-collector\f[R] as the \f[B]scchvc\f[R] user if a
valid configuration has been specified in the \f[B]scchvc\f[R] user
account.
.IP \[bu] 2
\f[B]scc-hypervisor-collector.timer(8)\f[R] triggers the
\f[B]scc-hypervisor-collector.service(8)\f[R] unit to be run on a daily
basis by default.
.SH CONFIGURATION SETTINGS
.PP
Configuration settings are specified in YAML format and must contain:
.IP \[bu] 2
a list of hypervisor \f[B]backends\f[R] from which to retrieve relevant
details
.IP \[bu] 2
a collection of \f[B]credentials\f[R] that will be used to upload the
collected details to the SUSE Customer Center.
.PP
See \f[B]scc-hypervisor-collector(5)\f[R] for details about the possible
configuration settings.
.SS CONFIGURATION MANAGEMENT
.PP
The configuration settings can be specified in a single YAML file, or as
a set of YAML files whose content will be merged together in lexical
sort order.
.PP
The latter scheme allows the configuration settings to be split up into
multiple files, e.g.
credentials can be specified in one file, and the hypervisor backends in
one or more files.
.PP
When splitting the hypervisor backend details among multiple files, the
\f[B]backends\f[R] lists in each file will be merged together to form a
single combined list; exact duplicates will be ignored but partial
duplicates will result in errors.
.SS ACCESS AND OWNERSHIP
.PP
For security reasons only the non-root user that is running the
\f[B]scc-hypervisor-collector\f[R] command should be able to access the
specified configuration files.
.SS CONFIGURATION VALIDATION
.PP
The \f[B]--check\f[R] option can be utilised to check if the specified
configuration settings are valid, or will report any errors that it
detected.
.SS SUPPORTED HYPERVISORS
.PP
The following hypervisor types are supported:
.IP \[bu] 2
VMWare vCenter (type \f[B]VMware\f[R])
.IP \[bu] 2
Libvirt (type \f[B]Libvirt\f[R])
.PP
Each hypervisor type has specific configuration settings that must be
provided to permit the relevant details to be retrieved; these settings
are documented in \f[B]scc-hypervisor-collector(5)\f[R].
.SH EXIT CODES
.PP
\f[B]scc-hypervisor-collector\f[R] sets the following exit codes:
.IP \[bu] 2
0: Run completed successfully, or configuration settings are valid if
check mode (\f[B]--check\f[R]) was specified.
.IP \[bu] 2
1: An error occurred.
.SH IMPLEMENTATION
.PP
\f[B]scc-hypervisor-collector(1)\f[R] is implemented in Python.
It communicates with the SUSE Customer Center via a RESTful JSON API
over HTTP using TLS encryption.
.SH ENVIRONMENT
.PP
\f[B]scc-hypervisor-collector(1)\f[R] respects the HTTP_PROXY
environment variable.
See https://www.suse.com/support/kb/doc/?id=000017441 for more details
on how to manually configure proxy usage.
.SH FILES AND DIRECTORIES
.TP
\f[B]\[ti]/.config/scc-hypervisor-collector/\f[R]
Default configuration directory containing YAML configuration files,
merged together in lexical sort order.
.TP
\f[B]\[ti]/scc-hypervisor-collector.log\f[R]
Default log file which will be automatically rotated and compressed if
it gets too large.
.TP
\f[B]/var/lib/scchvc/.config/scc-hypervisor-collector/\f[R]
Configuration directory that the
\f[B]scc-hypervisor-collector.service(8)\f[R] checks for configuration
settings.
.TP
\f[B]/var/lib/scchvc/scc-hypervisor-collector.log\f[R]
The log file used by the \f[B]scc-hypervisor-collector.service(8)\f[R].
.SH AUTHORS
.PP
Originally developed by Fergal Mc Carthy (fmccarthy\[at]suse.com) and
Meera Belur (mbelur\[at]suse.com) for the SCC at SUSE LLC
(scc-feedback\[at]suse.de)
.SH LINKS
.PP
SUSE Customer Center: https://scc.suse.com
.PP
scc-hypervisor-collector on GitHub:
https://github.com/SUSE/scc-hypervisor-collector
.PP
virtual-host-gatherer on GitHub:
https://github.com/uyuni-project/virtual-host-gatherer
.PP
YAML Specification: https://yaml.org/
.SH SEE ALSO
.PP
\f[B]scc-hypervisor-collector(5)\f[R],
\f[B]scc-hypervisor-collector.service(8)\f[R],
\f[B]scc-hypervisor-collector.timer(8)\f[R],
\f[B]virtual-host-gatherer(1)\f[R], \f[B]update-ca-certificates(8)\f[R],
\f[B]systemd(1)\f[R].
